# Changelog - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏

## 2025-10-17 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –±–∞–≥–æ–≤

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏:

#### 1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SQLAlchemy –Ω–∞ 2.0 API**
- ‚ùå **–ë—ã–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ `declarative_base()`
- ‚úÖ **–°—Ç–∞–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ `DeclarativeBase` —Å typed mappings
- **–§–∞–π–ª—ã**: `admin/backend/app/database.py`, `admin/backend/app/models.py`

#### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ UUID –≤ –º–æ–¥–µ–ª—è—Ö**
- ‚ùå **–ë—ã–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `UUID(as_uuid=True)` –∏–∑ PostgreSQL –¥–∏–∞–ª–µ–∫—Ç–∞
- ‚úÖ **–°—Ç–∞–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ `Uuid` —Ç–∏–ø–∞ —Å `Mapped[uuid.UUID]`
- **–§–∞–π–ª—ã**: `admin/backend/app/models.py`
- **–≠—Ñ—Ñ–µ–∫—Ç**: –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å SQLite, –∏ —Å PostgreSQL

#### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ UUID –≤ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**
- ‚ùå **–ë—ã–ª–æ**: `chat_id=str(chat.id)` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ UUID –≤ —Å—Ç—Ä–æ–∫—É
- ‚úÖ **–°—Ç–∞–ª–æ**: `chat_id=chat.id` - –ø–µ—Ä–µ–¥–∞—á–∞ UUID –æ–±—ä–µ–∫—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
- **–§–∞–π–ª—ã**: `bot.py`, `admin/backend/app/main.py`, `admin/backend/app/bot_integration.py`
- **–≠—Ñ—Ñ–µ–∫—Ç**: –ò–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ SQL –∑–∞–ø—Ä–æ—Å–æ–≤

#### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ async session factory**
- ‚ùå **–ë—ã–ª–æ**: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π `sessionmaker(class_=AsyncSession)`
- ‚úÖ **–°—Ç–∞–ª–æ**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π `async_sessionmaker()`
- **–§–∞–π–ª**: `admin/backend/app/database.py`

#### 5. **–£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–∫–∞ –ë–î**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `pool_pre_ping=True` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `pool_recycle=3600` –¥–ª—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω –∏–∑–±—ã—Ç–æ—á–Ω—ã–π echo –ª–æ–≥–∏–Ω–≥
- **–§–∞–π–ª**: `admin/backend/app/database.py`

#### 6. **–¢–∏–ø–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π SQLAlchemy**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å `Mapped[...]` –∏ `mapped_column()`
- ‚úÖ –£–∫–∞–∑–∞–Ω—ã `Optional` —Ç–∏–ø—ã –¥–ª—è nullable –ø–æ–ª–µ–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã datetime, uuid.UUID, int, str —Ç–∏–ø—ã
- **–§–∞–π–ª**: `admin/backend/app/models.py`

### üì¶ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:

1. **requirements.txt** - –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
2. **README_SETUP.md** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
3. **init_db.py** - –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. **start_bot.sh** - –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
5. **start_admin.sh** - –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –∞–¥–º–∏–Ω–∫–∏
6. **.env** - –§–∞–π–ª —Å —Ç–æ–∫–µ–Ω–∞–º–∏ (—Å –ø—Ä–∏–º–µ—Ä–∞–º–∏)
7. **.env.example** - –®–∞–±–ª–æ–Ω –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
8. **.gitignore** - –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤

### üîß –£–ª—É—á—à–µ–Ω–∏—è:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–¥–º–∏–Ω–∫–∏
- ‚úÖ –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø—Ä–µ—Å–µ—Ç "–ö–∏—Ä–∏–ª–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SQLite –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è PostgreSQL)
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:

- ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ SQLAlchemy 2.0 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SQLite –∏ PostgreSQL
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Gemini —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```bash
# 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python3 init_db.py

# 2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
./start_bot.sh
# –∏–ª–∏
python3 bot.py

# 3. –ó–∞–ø—É—Å–∫ –∞–¥–º–∏–Ω–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
./start_admin.sh
```

### üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. **GOOGLE_API_KEY** - –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ [ai.google.dev](https://ai.google.dev)
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite (dev_database.db)
3. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ PostgreSQL —á–µ—Ä–µ–∑ DATABASE_URL
4. **Redis** - –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω, –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ
